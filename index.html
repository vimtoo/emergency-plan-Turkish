<!DOCTYPE html>
<html lang="tr" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kuveyt'teki Diplomatik Misyon iÃ§in Acil Durum PlanÄ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; }
        .content-section { display: none; }
        .content-section.active { display: block; }
        .nav-link { transition: all 0.2s ease-in-out; }
        .nav-link.active { background-color: #2563eb; color: white; }
        .nav-link:hover { background-color: #dbeafe; color: #1e40af; }
        .nav-link.active:hover { background-color: #1d4ed8; }
        .accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
        .chart-container { position: relative; width: 100%; max-width: 600px; margin-left: auto; margin-right: auto; height: 300px; max-height: 350px; }
        .source-citation { font-size: 0.8rem; color: #6b7280; text-align: right; margin-top: 1rem; }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="relative min-h-screen md:flex">
        
        <!-- Mobile menu button -->
        <div class="absolute top-4 right-4 z-20 md:hidden">
             <button id="menu-toggle" class="p-2 bg-white rounded-md border">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg>
            </button>
        </div>

        <!-- Sidebar -->
        <aside id="sidebar" class="bg-gray-50 text-gray-800 w-64 space-y-6 py-7 px-2 absolute inset-y-0 left-0 transform -translate-x-full md:relative md:translate-x-0 transition duration-200 ease-in-out z-10 border-r">
            <div class="flex items-center mb-6 px-2">
                <div class="w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center shrink-0">
                    <span class="text-white text-2xl font-bold">!</span>
                </div>
                <h1 class="text-lg font-bold text-gray-700 mx-3">Acil Durum PlanÄ±</h1>
            </div>
            <nav id="main-nav">
                <ul>
                    <li><a href="#dashboard" class="nav-link flex items-center p-3 my-1 rounded-lg font-semibold text-gray-600">Kontrol Paneli</a></li>
                    <li><a href="#threats" class="nav-link flex items-center p-3 my-1 rounded-lg font-semibold text-gray-600">Radyolojik Tehditler</a></li>
                    <li><a href="#chemical" class="nav-link flex items-center p-3 my-1 rounded-lg font-semibold text-gray-600">Kimyasal Tehditler</a></li>
                    <li><a href="#preparedness" class="nav-link flex items-center p-3 my-1 rounded-lg font-semibold text-gray-600">KiÅŸisel HazÄ±rlÄ±k</a></li>
                    <li><a href="#shelter" class="nav-link flex items-center p-3 my-1 rounded-lg font-semibold text-gray-600">SÄ±ÄŸÄ±nak ve Korunma</a></li>
                    <li><a href="#procedures" class="nav-link flex items-center p-3 my-1 rounded-lg font-semibold text-gray-600">Acil Durum ProsedÃ¼rleri</a></li>
                    <li><a href="#medical" class="nav-link flex items-center p-3 my-1 rounded-lg font-semibold text-gray-600">TÄ±bbi MÃ¼dahale</a></li>
                </ul>
            </nav>
        </aside>

        
        <main class="flex-1 overflow-y-auto p-4 sm:p-6 lg:p-8">
            <section id="dashboard" class="content-section">
                <h2 class="text-2xl sm:text-3xl font-bold mb-2 text-gray-800">Ana Kontrol Paneli</h2>
                <p class="mb-6 text-gray-500">Mevcut duruma ve gereken acil eylemlere hÄ±zlÄ± bir genel bakÄ±ÅŸ.</p>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200 flex flex-col justify-between">
                        <div>
                           <h3 class="font-bold text-lg mb-2">Mevcut Tehdit Durumu (THREATCON)</h3>
                           <p class="text-sm text-gray-500 mb-4">Bu seviye, tÃ¼m personelden beklenen hazÄ±rlÄ±k durumunu belirler.</p>
                        </div>
                        <div id="threat-level-card" class="text-center p-4 rounded-lg">
                            <div id="threat-level-text" class="text-4xl font-bold"></div>
                            <div id="threat-level-desc" class="mt-2 font-semibold"></div>
                        </div>
                         <div class="mt-4 flex justify-center">
                            <select id="threat-level-selector" class="p-2 border rounded-md w-full"></select>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200 lg:col-span-2">
                        <h3 class="font-bold text-lg mb-4">AnÄ±nda Acil Durum Eylemleri</h3>
                        <p class="text-sm text-gray-500 mb-6">Acil bir durumda resmi talimatlarÄ± izleyin. Bunlar temel prosedÃ¼rlere hÄ±zlÄ± baÄŸlantÄ±lardÄ±r.</p>
                        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                            <button onclick="navigateTo('procedures', 'alpha')" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold p-4 rounded-lg text-center transition">
                                <span class="text-3xl">â˜¢ï¸</span>
                                <span class="block mt-2 text-sm sm:text-base">ProsedÃ¼r Alfa: Yerinde SÄ±ÄŸÄ±nak</span>
                            </button>
                            <button onclick="navigateTo('procedures', 'bravo')" class="bg-blue-500 hover:bg-blue-600 text-white font-bold p-4 rounded-lg text-center transition">
                                <span class="text-3xl">ğŸš—</span>
                                <span class="block mt-2 text-sm sm:text-base">ProsedÃ¼r Bravo: Tahliye</span>
                            </button>
                            <button onclick="navigateTo('procedures', 'charlie')" class="bg-red-500 hover:bg-red-600 text-white font-bold p-4 rounded-lg text-center transition">
                                <span class="text-3xl">ğŸš¨</span>
                                <span class="block mt-2 text-sm sm:text-base">ProsedÃ¼r Charlie: TerÃ¶r OlayÄ±</span>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="mt-8 bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                    <h3 class="font-bold text-lg mb-2">GÃ¼venlik Durumuna Genel BakÄ±ÅŸ</h3>
                    <p class="text-gray-600">BÃ¶lgedeki mevcut gÃ¼venlik durumu deÄŸiÅŸkendir ve hÄ±zla tÄ±rmanma potansiyeline sahiptir. Bir nÃ¼kleer tesise askeri saldÄ±rÄ± gibi herhangi bir olay, daha geniÅŸ ve daha dinamik bir Ã§atÄ±ÅŸmanÄ±n parÃ§asÄ± olacaktÄ±r. Acil durum planÄ±, askeri harekat, radyolojik kirlenme, terÃ¶rizm ve sivil huzursuzluk dahil olmak Ã¼zere birden fazla krizi aynÄ± anda yÃ¶netebilmelidir.</p>
                </div>
            </section>

            
            <section id="threats" class="content-section">
                <h2 class="text-2xl sm:text-3xl font-bold mb-2 text-gray-800">Radyolojik Tehditler ve UyarÄ± Sistemleri</h2>
                <p class="mb-6 text-gray-500">Potansiyel radyolojik riskleri ve resmi uyarÄ±larÄ± nasÄ±l alacaÄŸÄ±nÄ±zÄ± anlayÄ±n.</p>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-bold text-lg mb-4">Radyolojik Tehdit: BuÅŸehr Tesisi</h3>
                        <p class="text-sm text-gray-600 mb-4">Kuveyt iÃ§in ana radyolojik tehdit, KÃ¶rfez'in yaklaÅŸÄ±k 290 km karÅŸÄ±sÄ±nda bulunan Ä°ran'Ä±n BuÅŸehr NÃ¼kleer Santrali'dir. Herhangi bir radyoaktif salÄ±nÄ±mÄ±n ulaÅŸmasÄ± rÃ¼zgar yÃ¶nÃ¼ne baÄŸlÄ±dÄ±r.</p>
                        <div class="relative w-full h-64 bg-blue-100 rounded-lg overflow-hidden border-2 border-blue-200">
                            <div class="absolute top-1/2 right-1/4 transform -translate-y-1/2 text-center">
                                <div class="w-4 h-4 bg-yellow-400 rounded-full animate-ping"></div>
                                <span class="font-bold text-blue-800">Kuveyt</span>
                            </div>
                            <div class="absolute top-1/2 left-1/4 transform -translate-y-1/2 text-center">
                                <div class="w-4 h-4 bg-red-600 rounded-full"></div>
                                <span class="font-bold text-red-800">BuÅŸehr</span>
                            </div>
                            <div id="wind-plume" class="absolute top-1/2 left-1/4 h-1 bg-red-400/50 origin-left transition-all duration-1000" style="width: 150px;"></div>
                        </div>
                         <div class="mt-4 text-center">
                            <p class="text-sm mb-2">RÃ¼zgar YÃ¶nÃ¼nÃ¼ SimÃ¼le Edin:</p>
                            <div class="flex flex-col sm:flex-row justify-center gap-2">
                                <button id="shamal-wind-btn" class="px-4 py-2 bg-gray-200 rounded-md">Åimal RÃ¼zgarÄ± (Hakim)</button>
                                <button id="kaus-wind-btn" class="px-4 py-2 bg-red-200 rounded-md">Kaus RÃ¼zgarÄ± (Tehdit)</button>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-bold text-lg mb-4">Kuveyt Kamu UyarÄ± Sistemleri</h3>
                        <p class="text-sm text-gray-600 mb-4">Herhangi bÃ¼yÃ¼k bir olay iÃ§in ilk uyarÄ± Kuveyt makamlarÄ±ndan gelebilir. Sirenlerin ne anlama geldiÄŸini bilin.</p>
                        <div id="siren-guide" class="space-y-3"></div>
                        <div class="source-citation">Kaynak: Kuveyt Ä°Ã§iÅŸleri BakanlÄ±ÄŸÄ±, Sivil Savunma Genel MÃ¼dÃ¼rlÃ¼ÄŸÃ¼.</div>
                    </div>
                </div>
            </section>
            
            <section id="chemical" class="content-section">
                <h2 class="text-2xl sm:text-3xl font-bold mb-2 text-gray-800">Kimyasal Silah Tehditleri</h2>
                <p class="mb-6 text-gray-500">Sivil Savunma talimatlarÄ±na dayalÄ± olarak kimyasal maddelere maruz kalma durumunda prosedÃ¼rler ve ilk yardÄ±m.</p>
                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200 mb-6">
                    <h3 class="font-bold text-lg mb-4">Kimyasal SaldÄ±rÄ±lara KarÅŸÄ± Koruyucu Ã–nlemler</h3>
                    <div id="chem-measures-accordion" class="space-y-4"></div>
                    <div class="source-citation">Kaynak: Kuveyt Ä°Ã§iÅŸleri BakanlÄ±ÄŸÄ±, "Kimyasal Silahlarla SaldÄ±rÄ± Durumunda Ã–nleyici Tedbirler".</div>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                    <h3 class="font-bold text-lg mb-4">Kimyasal Maddeler iÃ§in Belirtiler ve Ä°lk YardÄ±m</h3>
                     <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left text-gray-500">
                            <thead class="text-xs text-gray-700 uppercase bg-gray-50">
                                <tr id="chem-table-header"></tr>
                            </thead>
                            <tbody id="chem-table-body"></tbody>
                        </table>
                    </div>
                     <div class="source-citation">Kaynak: Kuveyt Ä°Ã§iÅŸleri BakanlÄ±ÄŸÄ±, "Kimyasal Silahlarla SaldÄ±rÄ± Durumunda Ã–nleyici Tedbirler".</div>
                </div>
            </section>

            <section id="preparedness" class="content-section">
                <h2 class="text-2xl sm:text-3xl font-bold mb-2 text-gray-800">KiÅŸisel ve Ailevi HazÄ±rlÄ±k</h2>
                <p class="mb-6 text-gray-500">Ã–nceden hazÄ±rlÄ±k, gÃ¼venliÄŸin anahtarÄ±dÄ±r. Ailenizi hazÄ±rlamak iÃ§in bu araÃ§larÄ± kullanÄ±n.</p>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-bold text-lg mb-4">Evde Kalma Kiti (2 HaftalÄ±k Tedarik)</h3>
                        <div id="stay-kit-checklist" class="space-y-3 max-h-96 overflow-y-auto ps-2"></div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-bold text-lg mb-4">Acil Durum Ã‡antasÄ± (KiÅŸi BaÅŸÄ± - 72 Saat)</h3>
                        <div id="go-bag-checklist" class="space-y-3 max-h-96 overflow-y-auto ps-2"></div>
                    </div>
                </div>
                <div class="mt-8 bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                    <h3 class="font-bold text-lg mb-4">Aile Acil Durum PlanÄ±</h3>
                     <div class="space-y-4">
                        <div>
                            <label class="font-semibold">Ãœlke DÄ±ÅŸÄ± Ä°rtibat KiÅŸisi:</label>
                            <input type="text" placeholder="Ä°sim, yakÄ±nlÄ±k ve telefon numarasÄ±" class="mt-1 w-full p-2 border rounded-md">
                        </div>
                        <div>
                            <label class="font-semibold">BuluÅŸma NoktalarÄ±:</label>
                            <input type="text" placeholder="1. Evin yakÄ±nÄ± (Ã¶r. sokak kÃ¶ÅŸesi)" class="mt-1 w-full p-2 border rounded-md">
                            <input type="text" placeholder="2. Mahallede (Ã¶r. park)" class="mt-2 w-full p-2 border rounded-md">
                            <input type="text" placeholder="3. BÃ¼yÃ¼kelÃ§ilik toplanma alanÄ± (talimata gÃ¶re)" class="mt-2 w-full p-2 border rounded-md">
                        </div>
                        <div>
                            <label class="font-semibold">Ã–nemli Belgeleri SaklayÄ±n:</label>
                            <p class="text-sm text-gray-600">PasaportlarÄ±, doÄŸum belgelerini, sigorta poliÃ§elerini toplayÄ±n. Acil durum Ã§antanÄ±zda kaÄŸÄ±t kopyalarÄ±nÄ± ve ÅŸifreli dijital kopyalarÄ± bir USB sÃ¼rÃ¼cÃ¼de veya gÃ¼venli bulut depolamada saklayÄ±n.</p>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="shelter" class="content-section">
                <h2 class="text-2xl sm:text-3xl font-bold mb-2 text-gray-800">SÄ±ÄŸÄ±nak ve Korunma</h2>
                <p class="mb-6 text-gray-500">GÃ¼venli bir sÄ±ÄŸÄ±nak oluÅŸturma ve radyasyondan korunmayÄ± anlama konusunda ayrÄ±ntÄ±lÄ± rehberlik.</p>
                
                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200 mb-6">
                    <h3 class="font-bold text-lg mb-4">Ev SÄ±ÄŸÄ±naÄŸÄ±nÄ±zÄ± HazÄ±rlama</h3>
                    <p class="text-sm text-gray-600 mb-4">Radyolojik veya kimyasal bir acil durumda, en gÃ¼venli eylem iÃ§eri girmek ve dÄ±ÅŸ hava ile aranÄ±zda bir bariyer oluÅŸturmaktÄ±r. SÄ±ÄŸÄ±nak odanÄ±zÄ± Ã¶nceden nasÄ±l hazÄ±rlayacaÄŸÄ±nÄ±z aÅŸaÄŸÄ±da aÃ§Ä±klanmÄ±ÅŸtÄ±r.</p>
                    <div id="home-shelter-steps" class="space-y-4"></div>
                     <div class="source-citation">Kaynak: Kuveyt Ä°Ã§iÅŸleri BakanlÄ±ÄŸÄ±, Sivil Savunma Genel MÃ¼dÃ¼rlÃ¼ÄŸÃ¼.</div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-bold text-lg mb-4">Radyasyondan KorunmanÄ±n Temel Ä°lkeleri</h3>
                        <p class="text-sm text-gray-600 mb-4">GÃ¼venliÄŸiniz Ã¼Ã§ temel ilkeye baÄŸlÄ±dÄ±r: Zaman, Mesafe ve ZÄ±rhlama. Maruziyetinizi en aza indirmek anahtardÄ±r.</p>
                        <div id="rad-protection-principles" class="space-y-4"></div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-bold text-lg mb-4">Genel SÄ±ÄŸÄ±nak Bulucu</h3>
                        <p class="text-sm text-gray-600">Kuveyt Devleti genel sÄ±ÄŸÄ±naklar bulundurmaktadÄ±r. Acil bir durumda, yetkililer sÄ±ÄŸÄ±nak yerlerini duyuracaktÄ±r. Resmi Sivil Savunma hizmetini kullanarak en yakÄ±n belirlenmiÅŸ sÄ±ÄŸÄ±naÄŸÄ± bulmak iÃ§in bu aracÄ± kullanÄ±n.</p>
                        
                        <div class="mt-4 space-y-4 p-4 border rounded-lg bg-gray-50">
                            <div>
                                <label for="gov-select" class="block text-sm font-medium text-gray-700">Valilik</label>
                                <select id="gov-select" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"></select>
                            </div>
                             <div>
                                <label for="area-select" class="block text-sm font-medium text-gray-700">BÃ¶lge</label>
                                <select id="area-select" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"></select>
                            </div>
                            <button id="search-shelter-btn" class="w-full bg-blue-600 text-white font-bold py-2 px-4 rounded-md hover:bg-blue-700 transition">Resmi Web Sitesinde Ara</button>
                            <p class="text-xs text-center text-gray-500">Bu, yeni bir pencerede resmi Kuveyt Sivil Savunma sÄ±ÄŸÄ±nak arama aracÄ±nÄ± aÃ§acaktÄ±r.</p>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="procedures" class="content-section">
                <h2 class="text-2xl sm:text-3xl font-bold mb-2 text-gray-800">Standart Operasyon ProsedÃ¼rleri (SOP)</h2>
                <p class="mb-6 text-gray-500">Belirli acil durum senaryolarÄ± iÃ§in net, adÄ±m adÄ±m talimatlar.</p>
                <div id="procedures-accordion" class="space-y-4"></div>
            </section>

            
            <section id="medical" class="content-section">
                <h2 class="text-2xl sm:text-3xl font-bold mb-2 text-gray-800">TÄ±bbi MÃ¼dahale ve Dekontaminasyon</h2>
                <p class="mb-6 text-gray-500">SaÄŸlÄ±k risklerini ve maruziyeti azaltmak iÃ§in olay sonrasÄ± hayati eylemler.</p>
                <div class="grid grid-cols-1 lg:grid-cols-5 gap-6">
                    <div class="lg:col-span-3 bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-bold text-lg mb-4">Radyolojik Dekontaminasyon</h3>
                        <p class="text-sm text-gray-600 mb-4">Radyoaktif bir salÄ±nÄ±m sÄ±rasÄ±nda dÄ±ÅŸarÄ±daysanÄ±z, radyoaktif malzemeyi temizlemek iÃ§in bu adÄ±mlarÄ± derhal uygulayÄ±n.</p>
                        <ol id="decon-steps" class="list-decimal list-inside space-y-3">
                        </ol>
                         <div class="source-citation">Kaynak: Kuveyt Ä°Ã§iÅŸleri BakanlÄ±ÄŸÄ±, "Radyasyon ve Etkileri ve Ã–nleme YÃ¶ntemleri".</div>
                    </div>
                    <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-bold text-lg mb-4">Potasyum Ä°yodÃ¼r (KI) DozajlarÄ±</h3>
                        <p class="text-sm text-gray-600 mb-4"><strong>BÃ¼yÃ¼kelÃ§ilik tarafÄ±ndan aÃ§Ä±kÃ§a emredilmedikÃ§e ALMAYIN.</strong> Sadece tiroid bezini radyoaktif iyottan korur.</p>
                        <div class="chart-container">
                            <canvas id="ki-chart"></canvas>
                        </div>
                    </div>
                </div>
                 <div class="mt-8 bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                    <h3 class="font-bold text-lg mb-4">DetaylÄ± Potasyum Ä°yodÃ¼r Dozaj Tablosu</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-gray-500">
                            <thead class="text-xs text-gray-700 uppercase bg-gray-50">
                                <tr id="ki-table-header"></tr>
                            </thead>
                            <tbody id="ki-table-body"></tbody>
                        </table>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            
            // --- DATA GENERATORS ---
            
            const shelterLocations = {
                'Valilik SeÃ§in': [],
                'Al Asimah (BaÅŸkent)': ['Abdullah Al-Salem', 'Adailiya', 'Bneid Al-Qar', 'Daiya', 'Dasma', 'Faiha', 'Jibla', 'Kaifan', 'Khaldiya', 'Mansouriya', 'Mirqab', 'Nuzha', 'Qadsiya', 'Qortuba', 'Rawda', 'Salhiya', 'Shamiya', 'Sharq', 'Shuwaikh', 'Sulaibikhat', 'Yarmouk'],
                'Hawalli': ['Bayan', 'Hawalli', 'Jabriya', 'Mishref', 'Mubarak Al-Abdullah', 'Rumaithiya', 'Salmiya', 'Salwa', 'Shaab'],
                'Mubarak Al-Kabeer': ['Abu Al Hasaniya', 'Abu Ftaira', 'Adan', 'Al-Qurain', 'Al-Qusour', 'Fnaitees', 'Messila', 'Mubarak Al-Kabeer', 'Sabah Al-Salem', 'Wista'],
                'Al-Ahmadi': ['Abu Halifa', 'Ahmadi', 'Fahaheel', 'Fintas', 'Hadiya', 'Jaber Al-Ali', 'Mahboula', 'Mangaf', 'Reqqa', 'Sabahiya', 'Wafra', 'Zoor'],
                'Al-Farwaniya': ['Abdullah Al-Mubarak', 'HavaalanÄ±', 'Andalous', 'Ardiya', 'Ashbelia', 'Dhajeej', 'Farwaniya', 'Fordous', 'Jleeb Al-Shuyoukh', 'Khaitan', 'Omariya', 'Rabia', 'Reggai', 'Rai'],
                'Al-Jahra': ['Amghara', 'Jahra', 'Kabd', 'Naeem', 'Naseem', 'Oyoun', 'Qasr', 'Saad Al Abdullah', 'Sulaibiya', 'Taima', 'Waha']
            };

            function getThreatLevels() {
                return {
                    '4': { text: 'Seviye 4', desc: 'Normal', color: 'bg-green-100', textColor: 'text-green-800' },
                    '3': { text: 'Seviye 3', desc: 'Artan HazÄ±rlÄ±k', color: 'bg-blue-100', textColor: 'text-blue-800' },
                    '2': { text: 'Seviye 2', desc: 'YÃ¼ksek Alarm', color: 'bg-yellow-100', textColor: 'text-yellow-800' },
                    '1': { text: 'Seviye 1', desc: 'Kriz MÃ¼dahalesi', color: 'bg-red-100', textColor: 'text-red-800' }
                };
            }

            function getSirenData() {
                const data = [
                    { tone: 'Kesintili Ses', meaning: 'YakÄ±n Tehlike / UyarÄ±', action: 'OlasÄ± bir tehlike yaklaÅŸÄ±yor. Normal aktiviteyi durdurun. Ä°Ã§eri girin. Yerel medyayÄ± izleyin ve resmi bir BÃ¼yÃ¼kelÃ§ilik uyarÄ±sÄ± bekleyin. Acil durum prosedÃ¼rlerini uygulamaya hazÄ±rlanÄ±n.'},
                    { tone: 'DalgalÄ± Ses', meaning: 'Tehlike GerÃ§ekleÅŸti', action: 'Felaket veya saldÄ±rÄ± ÅŸu anda gerÃ§ekleÅŸiyor. <strong>Derhal Yerinde SÄ±ÄŸÄ±nak ProsedÃ¼rÃ¼nÃ¼ (ProsedÃ¼r Alfa) uygulayÄ±n.</strong> Belirlenen sÄ±ÄŸÄ±nak odanÄ±za geÃ§in. BÃ¼yÃ¼kelÃ§ilik mesajÄ± beklemeyin.'},
                    { tone: 'SÃ¼rekli Ses', meaning: 'Tehlike GeÃ§ti', action: 'Ani tehlike geÃ§ti. <strong>SÄ±ÄŸÄ±nakta kalÄ±n.</strong> BÃ¼yÃ¼kelÃ§ilikten resmi bir "TEHLÄ°KE GEÃ‡TÄ°" talimatÄ± alana kadar ayrÄ±lmayÄ±n. Daha fazla talimat bekleyin.'}
                ];
                const colors = ['bg-blue-100', 'bg-yellow-100', 'bg-green-100'];
                return data.map((item, index) => ({ ...item, color: colors[index] }));
            }
            
            function getChemicalData() {
                return {
                    measures: [
                        { title: 'SaldÄ±rÄ±dan Ã–nce (HazÄ±rlÄ±k)', content: '<ul><li>SÄ±ÄŸÄ±nak odanÄ±zÄ± hazÄ±rlayÄ±n (SÄ±ÄŸÄ±nak bÃ¶lÃ¼mÃ¼ne bakÄ±n).</li><li>Acil durum kitinizin plastik Ã¶rtÃ¼, koli bandÄ± ve makas iÃ§erdiÄŸinden emin olun.</li><li>HavalandÄ±rma sistemlerini nasÄ±l hÄ±zlÄ±ca kapatacaÄŸÄ±nÄ±zÄ± Ã¶ÄŸrenin.</li><li>Gaz maskeniz varsa, kontrol edin ve yÃ¼zÃ¼nÃ¼ze tam oturduÄŸundan emin olun.</li></ul>' },
                        { title: 'SaldÄ±rÄ± SÄ±rasÄ±nda (DÄ±ÅŸarÄ±daysanÄ±z)', content: '<ul><li>SaldÄ±rÄ±nÄ±n yÃ¶nÃ¼nÃ¼ belirlemeye Ã§alÄ±ÅŸÄ±n ve rÃ¼zgarÄ±n tersi yÃ¶nde hÄ±zla hareket edin.</li><li>AÄŸzÄ±nÄ±zÄ± ve burnunuzu bir bezle kapatÄ±n (Ä±slak bez daha iyidir).</li><li>En yakÄ±n saÄŸlam, kapalÄ± binaya sÄ±ÄŸÄ±nÄ±n.</li></ul>' },
                        { title: 'SaldÄ±rÄ± SÄ±rasÄ±nda (AraÃ§taysanÄ±z)', content: '<ul><li>TÃ¼m pencereleri kapatÄ±n ve tÃ¼m havalandÄ±rma ve klima sistemlerini kapatÄ±n.</li><li>MÃ¼mkÃ¼nse etkilenen bÃ¶lgeden araÃ§la uzaklaÅŸÄ±n.</li><li>UzaklaÅŸamÄ±yorsanÄ±z, aracÄ± park edin ve en yakÄ±n binaya sÄ±ÄŸÄ±nÄ±n.</li></ul>' },
                        { title: 'SaldÄ±rÄ±dan Sonra (Olay SonrasÄ± Eylemler)', content: '<ul><li>Ã–nceden seÃ§tiÄŸiniz sÄ±ÄŸÄ±nak odanÄ±za gidin ve mÃ¼hÃ¼rleyin.</li><li>DÄ±ÅŸ katman giysilerinizi Ã§Ä±karÄ±n, plastik bir torbaya koyup kapatÄ±n ve kendinizi sabun ve suyla iyice yÄ±kayÄ±n.</li><li>Yetkililerden gelen resmi talimatlar iÃ§in radyoyu dinleyin.</li><li>KirlenmiÅŸ olabileceÄŸinden ÅŸÃ¼phelendiÄŸiniz yiyecek veya suyu tÃ¼ketmeyin.</li></ul>' }
                    ],
                    firstAidHeaders: ['Ajan Tipi', 'Belirtiler', 'Ä°lk YardÄ±m'],
                    firstAid: [
                        { type: 'Sinir GazlarÄ± (Ã¶rn. Sarin)', symptoms: 'Nefes almada zorluk, gÃ¶z bebeklerinde daralma, salya akmasÄ±, kasÄ±lmalar, bilinÃ§ kaybÄ±.', aid: 'Derhal temiz havaya Ã§Ä±kÄ±n. KirlenmiÅŸ giysileri Ã§Ä±karÄ±n. Cildi ve gÃ¶zleri bol su ile yÄ±kayÄ±n. Acil tÄ±bbi yardÄ±m alÄ±n.' },
                        { type: 'YakÄ±cÄ± Gazlar (Ã¶rn. Hardal GazÄ±)', symptoms: 'Ciltte kÄ±zarÄ±klÄ±k ve kabarcÄ±klar (ÅŸiddetli yanÄ±klar gibi), gÃ¶z tahriÅŸi, solunum sorunlarÄ±.', aid: 'Temiz havaya Ã§Ä±kÄ±n. KirlenmiÅŸ giysileri Ã§Ä±karÄ±n. Cildi su ile yÄ±kayÄ±n. KabarcÄ±klarÄ± patlatmayÄ±n. Acil tÄ±bbi yardÄ±m alÄ±n.' }
                    ]
                };
            }

            function getKitData() {
                return {
                    stayKit: ['Su (kiÅŸi baÅŸÄ± gÃ¼nde 4 litre)', 'DayanÄ±ksÄ±z gÄ±da (2 haftalÄ±k tedarik)', 'Manuel konserve aÃ§acaÄŸÄ±', 'Plastik Ã¶rtÃ¼ ve koli bandÄ±', 'Toz maskeleri (N95 veya P100)', 'KapsamlÄ± ilk yardÄ±m kiti', 'KiÅŸisel ilaÃ§lar (1 aylÄ±k tedarik)', 'Pilli veya elle Ã§alÄ±ÅŸan radyo', 'Yedek piller', 'El fenerleri', 'Hijyen malzemeleri (Ä±slak mendil vb.)'].map(text => ({ text, checked: false })),
                    goBag: ['Su ve yiyecek (3 gÃ¼nlÃ¼k tedarik)', 'Yedek giysi ve saÄŸlam ayakkabÄ±lar', 'Ã–nemli belgelerin kopyalarÄ±', 'KÃ¼Ã§Ã¼k banknotlar halinde nakit', 'Gerekli ilaÃ§lar (7 gÃ¼nlÃ¼k tedarik)', 'MÃ¼hÃ¼rlÃ¼ bir torbada temiz giysiler', 'KÃ¼Ã§Ã¼k ilk yardÄ±m kiti', 'TaÅŸÄ±nabilir radyo ve el feneri', 'Yedek piller', 'Yerel harita'].map(text => ({ text, checked: false }))
                };
            }
            
            function getProceduresData() {
                return [
                    { id: 'alpha', title: 'ProsedÃ¼r Alfa: Yerinde SÄ±ÄŸÄ±nak (Radyolojik/Kimyasal)', icon: 'â˜¢ï¸', content: '<p class="mb-4">AmaÃ§, sizi havadaki kirleticilerden korumaktÄ±r...</p><p class="font-bold text-lg mb-2 text-center">"Ä°Ã§eri Gir, Ä°Ã§eride Kal, Dinle"</p><ol class="list-decimal list-inside space-y-2"><li><strong>Ä°Ã§eri Gir:</strong> Derhal en yakÄ±n saÄŸlam binaya girin.</li><li><strong>Ä°Ã§eride Kal:</strong> Ã–nceden belirlenmiÅŸ sÄ±ÄŸÄ±nak odanÄ±za geÃ§in.</li><li><strong>MÃ¼hÃ¼rle:</strong> Pencereleri ve kapÄ±larÄ± kapatÄ±n. TÃ¼m klima ve havalandÄ±rma sistemlerini kapatÄ±n. "SÄ±ÄŸÄ±nak" bÃ¶lÃ¼mÃ¼ndeki ayrÄ±ntÄ±lÄ± mÃ¼hÃ¼rleme adÄ±mlarÄ±nÄ± izleyin.</li><li><strong>Dinle:</strong> Resmi talimatlar iÃ§in radyonuzu kullanÄ±n.</li><li><strong>AyrÄ±lma:</strong> Resmi bir "TEHLÄ°KE GEÃ‡TÄ°" talimatÄ± alana kadar sÄ±ÄŸÄ±nakta kalÄ±n.</li></ol>' },
                    { id: 'bravo', title: 'ProsedÃ¼r Bravo: Tahliye', icon: 'ğŸš—', content: '<p class="mb-4">Tahliye yalnÄ±zca Misyon Åefi tarafÄ±ndan emredilecektir...</p><p class="font-bold mb-2">Tahliye emri alÄ±ndÄ±ÄŸÄ±nda:</p><ol class="list-decimal list-inside space-y-2"><li>Sakin olun ve dinleyin.</li><li>Ailenizi ve acil durum Ã§antalarÄ±nÄ±zÄ± toplayÄ±n.</li><li>Zaman varsa, ana ÅŸebekeleri kapatÄ±n.</li><li>Evinizi kilitleyin.</li><li>Belirlenen toplanma noktasÄ±na gidin.</li><li>VarÄ±ÅŸta derhal kayÄ±t yaptÄ±rÄ±n.</li></ol>' },
                    { id: 'charlie', title: 'ProsedÃ¼r Charlie: TerÃ¶r OlayÄ±', icon: 'ğŸš¨', content: '<p class="mb-4">BÃ¶lge GÃ¼venlik GÃ¶revlisinin (RSO) talimatlarÄ±nÄ± izleyin...</p><div class="space-y-4"><h4 class="font-bold">Aktif bir saldÄ±rgan durumunda:</h4><ul class="list-disc list-inside"><li><strong>KaÃ§:</strong> GÃ¼venli bir kaÃ§Ä±ÅŸ yolu varsa, derhal ayrÄ±lÄ±n.</li><li><strong>Saklan:</strong> KaÃ§amazsanÄ±z, gÃ¼venli bir yer bulun.</li><li><strong>SavaÅŸ:</strong> Son Ã§are olarak, fiziksel saldÄ±rganlÄ±kla hareket edin.</li></ul></div>' }
                ];
            }

            function getDeconData() {
                return ['<strong>DÄ±ÅŸ giysileri Ã§Ä±karÄ±n:</strong> DÄ±ÅŸ giysi katmanÄ±nÄ± sallamaktan kaÃ§Ä±narak dikkatlice Ã§Ä±karÄ±n. Plastik bir torbaya koyun ve aÄŸzÄ±nÄ± kapatÄ±n. Bu torbayÄ± insanlardan ve evcil hayvanlardan uzak tutun.', '<strong>Ä°yice yÄ±kanÄ±n:</strong> IlÄ±k (sÄ±cak deÄŸil) bir duÅŸ alÄ±n, tÃ¼m vÃ¼cudunuzu ve saÃ§Ä±nÄ±zÄ± sabun ve ÅŸampuanla yÄ±kayÄ±n. DuÅŸ imkanÄ± yoksa, tÃ¼m aÃ§Ä±k ten bÃ¶lgelerini, Ã¶zellikle elleri ve yÃ¼zÃ¼ temizlemek iÃ§in Ä±slak mendil veya Ä±slak bir bez kullanÄ±n.', '<strong>Temiz giysiler giyin:</strong> Kirli havadan uzakta, kapalÄ± bir Ã§ekmece veya dolapta saklanan tamamen temiz giysiler giyin.', '<strong>MÃ¼mkÃ¼nse baÅŸkalarÄ±na yardÄ±m edin:</strong> BaÅŸkalarÄ±nÄ±n dekontaminasyonuna yardÄ±m etmeniz gerekiyorsa, su geÃ§irmez eldiven ve maske takmaya Ã§alÄ±ÅŸÄ±n. Onlara da aynÄ± adÄ±mlarÄ± izlemelerini tavsiye edin.'];
            }

            function getKiData() {
                return {
                    chartLabel: 'Potasyum Ä°yodÃ¼r Dozu (mg)',
                    chartTitle: 'YaÅŸ Grubuna GÃ¶re Dozajlar',
                    labels: ['YenidoÄŸan (0-1 ay)', 'Bebekler (1-3 yaÅŸ)', 'Ã‡ocuklar (3-12 yaÅŸ)', 'Ergenler (12-18)', 'YetiÅŸkinler (18-40)', 'Hamile/Emziren'],
                    dosages: [16.25, 32.5, 65, 130, 130, 130],
                    tableHeaders: ['YaÅŸ Grubu', 'Ã–nerilen Doz', 'Ã–nemli Notlar'],
                    table: [
                      { age: '40 yaÅŸ Ã¼stÃ¼ yetiÅŸkinler', dose: '130 mg', notes: 'Genellikle tavsiye edilmez.' },
                      { age: '18 ila 40 yaÅŸ arasÄ± yetiÅŸkinler', dose: '130 mg', notes: 'Standart yetiÅŸkin dozu.' },
                      { age: 'Hamile ve Emziren KadÄ±nlar', dose: '130 mg', notes: 'En yÃ¼ksek Ã¶ncelik. Tek doz.' },
                      { age: 'Ergenler (12 ila 18 yaÅŸ)', dose: '130 mg', notes: 'Standart yetiÅŸkin dozu.' },
                      { age: 'Ã‡ocuklar (3 ila 12 yaÅŸ)', dose: '65 mg', notes: 'YetiÅŸkin dozunun yarÄ±sÄ±.' },
                      { age: 'Bebekler (1 ay ila 3 yaÅŸ)', dose: '32.5 mg', notes: 'YetiÅŸkin dozunun Ã§eyreÄŸi.' },
                      { age: 'YenidoÄŸanlar (doÄŸumdan 1 aya kadar)', dose: '16.25 mg', notes: 'YetiÅŸkin dozunun sekizde biri. Tek doz.' }
                    ]
                };
            }
            
            function getShelterData() {
                return {
                    steps: [
                        { title: 'AdÄ±m 1: En Ä°yi OdayÄ± SeÃ§in', text: 'Tercihen bodrum katÄ±nda veya zemin katta, en az pencere ve kapÄ±ya sahip bir iÃ§ oda seÃ§in. AmaÃ§, sizinle dÄ±ÅŸarÄ±sÄ± arasÄ±na mÃ¼mkÃ¼n olduÄŸunca fazla katÄ± malzeme koymaktÄ±r.' },
                        { title: 'AdÄ±m 2: Malzemeleri Ã–nceden ToplayÄ±n', text: 'Evde Kalma Kitinizi, sÄ±zdÄ±rmazlÄ±k malzemeleri (plastik Ã¶rtÃ¼, koli bandÄ±) dahil olmak Ã¼zere, hÄ±zlÄ± eriÅŸim iÃ§in sÄ±ÄŸÄ±nak odanÄ±zda veya yakÄ±nÄ±nda saklayÄ±n.' },
                        { title: 'AdÄ±m 3: Talimat VerildiÄŸinde OdayÄ± MÃ¼hÃ¼rleyin', text: 'SÄ±ÄŸÄ±nma talimatÄ± verildiÄŸinde, tÃ¼m vantilatÃ¶rleri, klimalarÄ± ve Ä±sÄ±tma sistemlerini kapatÄ±n. Pencereleri, prizleri ve havalandÄ±rmalarÄ± Ã¶rtmek iÃ§in koli bandÄ± ve plastik Ã¶rtÃ¼ kullanÄ±n. Havadaki partikÃ¼llere karÅŸÄ± daha iyi bir sÄ±zdÄ±rmazlÄ±k saÄŸlamak iÃ§in kapÄ±larÄ±n altÄ±na Ä±slak havlular yerleÅŸtirin.' },
                        { title: 'AdÄ±m 4: Ä°Ã§eride KalÄ±n ve TalimatlarÄ± Dinleyin', text: 'MÃ¼hÃ¼rlenmiÅŸ odada kalÄ±n. Yetkililerden gelen resmi talimatlarÄ± dinlemek iÃ§in pilli radyonuzu kullanÄ±n. "Tehlike GeÃ§ti" mesajÄ±nÄ± alana kadar ayrÄ±lmayÄ±n.' }
                    ],
                    principles: [
                        { title: 'Zaman', text: 'Maruz kalma sÃ¼renizi sÄ±nÄ±rlayÄ±n. Bir radyasyon kaynaÄŸÄ±nÄ±n yakÄ±nÄ±nda ne kadar az zaman geÃ§irirseniz, dozunuz o kadar dÃ¼ÅŸÃ¼k olur. Ã–nerilen sÃ¼re boyunca sÄ±ÄŸÄ±naÄŸÄ±nÄ±zda kalma talimatlarÄ±nÄ± izleyin.' },
                        { title: 'Mesafe', text: 'Bir radyasyon kaynaÄŸÄ±ndan ne kadar uzakta olursanÄ±z o kadar gÃ¼vende olursunuz. Radyasyonun yoÄŸunluÄŸu mesafe ile Ã¶nemli Ã¶lÃ§Ã¼de azalÄ±r. Bu nedenle tahliye (gÃ¼venli kabul edildiÄŸinde) Ã¶nemli bir stratejidir.' },
                        { title: 'ZÄ±rhlama', text: 'Sizinle radyasyon kaynaÄŸÄ± arasÄ±na yoÄŸun bir malzeme (kalkan) yerleÅŸtirin. Beton, tuÄŸla ve toprak mÃ¼kemmel zÄ±rhlama malzemeleridir. Merkezi, penceresiz bir odada veya bodrum katÄ±nda sÄ±ÄŸÄ±nmanÄ±n arkasÄ±ndaki ilke budur.' }
                    ]
                };
            }


            // --- ELEMENTS ---
            const navLinks = document.querySelectorAll('.nav-link');
            const contentSections = document.querySelectorAll('.content-section');
            const threatLevelSelector = document.getElementById('threat-level-selector');
            const threatLevelCard = document.getElementById('threat-level-card');
            const threatLevelText = document.getElementById('threat-level-text');
            const threatLevelDesc = document.getElementById('threat-level-desc');
            const menuToggle = document.getElementById('menu-toggle');
            const sidebar = document.getElementById('sidebar');
            const govSelect = document.getElementById('gov-select');
            const areaSelect = document.getElementById('area-select');
            const searchShelterBtn = document.getElementById('search-shelter-btn');
            let kiChartInstance;

            // --- FUNCTIONS ---
            function navigateTo(sectionId, subSectionId = null) {
                contentSections.forEach(section => section.classList.remove('active'));
                const activeSection = document.getElementById(sectionId);
                if (activeSection) activeSection.classList.add('active');

                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href') === `#${sectionId}`) link.classList.add('active');
                });
                
                if(sidebar.classList.contains('translate-x-0')) {
                    sidebar.classList.remove('translate-x-0');
                    sidebar.classList.add('-translate-x-full');
                }

                if (subSectionId) {
                    const element = document.getElementById(subSectionId);
                    if (element && element.closest('.accordion-toggle')) {
                        document.querySelectorAll('.accordion-toggle').forEach(acc => {
                           acc.nextElementSibling.style.maxHeight = null;
                           acc.querySelector('span:last-child').style.transform = 'rotate(0deg)';
                        });
                        const content = element.nextElementSibling;
                        content.style.maxHeight = content.scrollHeight + "px";
                        element.querySelector('span:last-child').style.transform = 'rotate(180deg)';
                        element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                }
            }
            
            function updateThreatLevel(level) {
                const threatLevels = getThreatLevels();
                const levelData = threatLevels[level];
                threatLevelText.textContent = levelData.text;
                threatLevelDesc.textContent = levelData.desc;
                threatLevelCard.className = 'text-center p-4 rounded-lg transition-colors duration-300 ' + levelData.color + ' ' + levelData.textColor;
            }

            function populateThreatSelector() {
                const threatLevels = getThreatLevels();
                const currentVal = threatLevelSelector.value || '4';
                threatLevelSelector.innerHTML = '';
                Object.entries(threatLevels).forEach(([key, val]) => {
                    const option = document.createElement('option');
                    option.value = key;
                    option.textContent = `${val.text}: ${val.desc}`;
                    threatLevelSelector.appendChild(option);
                });
                threatLevelSelector.value = currentVal;
            }
            
            function createChecklist(containerId, data) {
                const container = document.getElementById(containerId);
                container.innerHTML = '';
                data.forEach(item => {
                    const label = document.createElement('label');
                    label.className = 'flex items-center p-2 bg-gray-50 rounded-md hover:bg-gray-100 cursor-pointer';
                    const checkbox = document.createElement('input');
                    checkbox.type = 'checkbox';
                    checkbox.className = 'mr-3 form-checkbox h-5 w-5 text-blue-600 rounded';
                    checkbox.checked = item.checked;
                    label.appendChild(checkbox);
                    label.append(item.text);
                    container.appendChild(label);
                });
            }
            
            function populateSirens() {
                const container = document.getElementById('siren-guide');
                container.innerHTML = '';
                getSirenData().forEach(siren => {
                    const div = document.createElement('div');
                    div.className = `p-4 rounded-lg border cursor-pointer ${siren.color}`;
                    div.innerHTML = `
                        <div class="flex justify-between items-center">
                            <h4 class="font-bold">${siren.tone}</h4>
                            <span class="text-sm font-semibold">${siren.meaning}</span>
                        </div>
                        <p class="siren-action mt-2 text-sm hidden">${siren.action}</p>
                    `;
                    div.addEventListener('click', () => div.querySelector('.siren-action').classList.toggle('hidden'));
                    container.appendChild(div);
                });
            }
            
            function populateProcedures(containerId, data) {
                const container = document.getElementById(containerId);
                container.innerHTML = '';
                data.forEach(item => {
                    const div = document.createElement('div');
                    div.className = 'bg-white rounded-xl shadow-sm border border-gray-200';
                    div.innerHTML = `
                        <button id="${item.id || ''}" class="accordion-toggle w-full p-4 text-left flex justify-between items-center font-bold text-lg">
                            <span>${item.icon || ''} ${item.title}</span>
                            <span class="transform transition-transform duration-300">â–¼</span>
                        </button>
                        <div class="accordion-content px-4 pb-4 text-gray-600">${item.content}</div>
                    `;
                    container.appendChild(div);
                });
                document.querySelectorAll('.accordion-toggle').forEach(button => {
                    button.addEventListener('click', () => {
                        const content = button.nextElementSibling;
                        const icon = button.querySelector('span:last-child');
                        const isOpen = content.style.maxHeight;
                        const allContent = button.closest('.space-y-4').querySelectorAll('.accordion-content');
                        const allIcons = button.closest('.space-y-4').querySelectorAll('.accordion-toggle span:last-child');
                        allContent.forEach(c => c.style.maxHeight = null);
                        allIcons.forEach(i => i.style.transform = 'rotate(0deg)');
                        
                        if (!isOpen || content.style.maxHeight === '0px') {
                            content.style.maxHeight = content.scrollHeight + "px";
                            icon.style.transform = 'rotate(180deg)';
                        } else {
                            content.style.maxHeight = null;
                            icon.style.transform = 'rotate(0deg)';
                        }
                    });
                });
            }

            function populateChemicalSection() {
                const chemData = getChemicalData();
                populateProcedures('chem-measures-accordion', chemData.measures.map(m => ({...m, icon: 'â˜£ï¸'})));

                const thead = document.getElementById('chem-table-header');
                thead.innerHTML = '';
                chemData.firstAidHeaders.forEach(header => {
                    const th = document.createElement('th');
                    th.scope = 'col';
                    th.className = 'px-6 py-3';
                    th.textContent = header;
                    thead.appendChild(th);
                });

                const tbody = document.getElementById('chem-table-body');
                tbody.innerHTML = '';
                chemData.firstAid.forEach(row => {
                    const tr = document.createElement('tr');
                    tr.className = 'bg-white border-b';
                    tr.innerHTML = `
                        <th scope="row" class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap">${row.type}</th>
                        <td class="px-6 py-4">${row.symptoms}</td>
                        <td class="px-6 py-4">${row.aid}</td>
                    `;
                    tbody.appendChild(tr);
                });
            }

            function populateDeconSteps() {
                const container = document.getElementById('decon-steps');
                container.innerHTML = '';
                getDeconData().forEach(step => {
                    const li = document.createElement('li');
                    li.innerHTML = step;
                    container.appendChild(li);
                });
            }

            function populateKiTable() {
                const kiData = getKiData();
                const thead = document.getElementById('ki-table-header');
                thead.innerHTML = '';
                kiData.tableHeaders.forEach(header => {
                    const th = document.createElement('th');
                    th.scope = 'col';
                    th.className = 'px-6 py-3';
                    th.textContent = header;
                    thead.appendChild(th);
                });

                const tbody = document.getElementById('ki-table-body');
                tbody.innerHTML = '';
                kiData.table.forEach(row => {
                    const tr = document.createElement('tr');
                    tr.className = 'bg-white border-b';
                    tr.innerHTML = `
                        <th scope="row" class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap">${row.age}</th>
                        <td class="px-6 py-4">${row.dose}</td>
                        <td class="px-6 py-4">${row.notes}</td>
                    `;
                    tbody.appendChild(tr);
                });
            }

            function createKiChart() {
                if (kiChartInstance) {
                    kiChartInstance.destroy();
                }
                const kiData = getKiData();
                const ctx = document.getElementById('ki-chart').getContext('2d');
                kiChartInstance = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: kiData.labels,
                        datasets: [{
                            label: kiData.chartLabel,
                            data: kiData.dosages,
                            backgroundColor: 'rgba(59, 130, 246, 0.5)',
                            borderColor: 'rgba(59, 130, 246, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false, indexAxis: 'y',
                        scales: { x: { beginAtZero: true } },
                        plugins: { legend: { display: false }, title: { display: true, text: kiData.chartTitle } }
                    }
                });
            }
            
            function populateShelterLocator() {
                govSelect.innerHTML = '';
                Object.keys(shelterLocations).forEach(gov => {
                    const option = document.createElement('option');
                    option.value = gov;
                    option.textContent = gov;
                    govSelect.appendChild(option);
                });
                govSelect.dispatchEvent(new Event('change'));
            }

            function updateAreaDropdown() {
                const selectedGov = govSelect.value;
                const areas = shelterLocations[selectedGov] || [];
                areaSelect.innerHTML = '';
                
                if (areas.length === 0) {
                     const option = document.createElement('option');
                     option.textContent = 'BÃ¶lge SeÃ§in';
                     areaSelect.appendChild(option);
                }

                areas.forEach(area => {
                    const option = document.createElement('option');
                    option.value = area;
                    option.textContent = area;
                    areaSelect.appendChild(option);
                });
            }
            
            function populateShelterInfo() {
                const shelterData = getShelterData();
                const stepsContainer = document.getElementById('home-shelter-steps');
                stepsContainer.innerHTML = '';
                shelterData.steps.forEach(step => {
                    const div = document.createElement('div');
                    div.innerHTML = `<h4 class="font-semibold text-md text-gray-700">${step.title}</h4><p class="text-sm text-gray-600">${step.text}</p>`;
                    stepsContainer.appendChild(div);
                });

                const principlesContainer = document.getElementById('rad-protection-principles');
                principlesContainer.innerHTML = '';
                shelterData.principles.forEach(principle => {
                    const div = document.createElement('div');
                    div.innerHTML = `<h4 class="font-semibold text-md text-gray-700">${principle.title}</h4><p class="text-sm text-gray-600">${principle.text}</p>`;
                    principlesContainer.appendChild(div);
                });
                
                populateShelterLocator();
            }

            // --- EVENT LISTENERS ---
            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    navigateTo(e.currentTarget.getAttribute('href').substring(1));
                });
            });

            threatLevelSelector.addEventListener('change', (e) => {
                updateThreatLevel(e.target.value);
            });
            
            menuToggle.addEventListener('click', () => {
                sidebar.classList.toggle('-translate-x-full');
                sidebar.classList.toggle('translate-x-0');
            });

            document.getElementById('shamal-wind-btn').addEventListener('click', () => {
                const plume = document.getElementById('wind-plume');
                plume.style.transform = 'translateY(-50%) rotate(-45deg)';
            });

            document.getElementById('kaus-wind-btn').addEventListener('click', () => {
                const plume = document.getElementById('wind-plume');
                plume.style.transform = 'translateY(-50%) rotate(45deg)';
            });
            
            govSelect.addEventListener('change', () => {
                updateAreaDropdown();
            });
            
            searchShelterBtn.addEventListener('click', () => {
                window.open('https://www.moi.gov.kw/main/eservices/civildefence/shelters', '_blank');
            });

            // --- INITIALIZATION ---
            function init() {
                populateThreatSelector();
                updateThreatLevel('4');
                populateSirens();
                const kitData = getKitData();
                createChecklist('stay-kit-checklist', kitData.stayKit);
                createChecklist('go-bag-checklist', kitData.goBag);
                populateProcedures('procedures-accordion', getProceduresData());
                populateChemicalSection();
                populateDeconSteps();
                populateKiTable();
                createKiChart();
                populateShelterInfo();

                const hash = window.location.hash.substring(1) || 'dashboard';
                navigateTo(hash);
                document.getElementById('shamal-wind-btn').click();
            }
            
            init();

            window.navigateTo = navigateTo;
        });
    </script>
</body>
</html>
