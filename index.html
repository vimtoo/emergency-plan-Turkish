<!DOCTYPE html>
<html lang="tr" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kuveyt'teki Diplomatik Misyon için Acil Durum Planı</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; }
        .content-section { display: none; }
        .content-section.active { display: block; }
        .nav-link { transition: all 0.2s ease-in-out; }
        .nav-link.active { background-color: #2563eb; color: white; }
        .nav-link:hover { background-color: #dbeafe; color: #1e40af; }
        .nav-link.active:hover { background-color: #1d4ed8; }
        .accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
        .chart-container { position: relative; width: 100%; max-width: 600px; margin-left: auto; margin-right: auto; height: 350px; max-height: 400px; }
        .source-citation { font-size: 0.8rem; color: #6b7280; text-align: right; margin-top: 1rem; }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="flex h-screen bg-white">
        
        <aside id="sidebar" class="w-64 bg-gray-50 p-4 flex-shrink-0 transition-transform -translate-x-full sm:translate-x-0 border-e">
            <div class="flex items-center mb-6">
                <div class="w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center shrink-0">
                    <span class="text-white text-2xl font-bold">!</span>
                </div>
                <h1 class="text-lg font-bold text-gray-700 mx-3">Acil Durum Planı</h1>
            </div>
            <nav id="main-nav">
                <ul>
                    <li><a href="#dashboard" class="nav-link flex items-center p-3 my-1 rounded-lg font-semibold text-gray-600">Kontrol Paneli</a></li>
                    <li><a href="#threats" class="nav-link flex items-center p-3 my-1 rounded-lg font-semibold text-gray-600">Radyolojik Tehditler</a></li>
                    <li><a href="#chemical" class="nav-link flex items-center p-3 my-1 rounded-lg font-semibold text-gray-600">Kimyasal Tehditler</a></li>
                    <li><a href="#preparedness" class="nav-link flex items-center p-3 my-1 rounded-lg font-semibold text-gray-600">Kişisel Hazırlık</a></li>
                    <li><a href="#shelter" class="nav-link flex items-center p-3 my-1 rounded-lg font-semibold text-gray-600">Sığınak ve Korunma</a></li>
                    <li><a href="#procedures" class="nav-link flex items-center p-3 my-1 rounded-lg font-semibold text-gray-600">Acil Durum Prosedürleri</a></li>
                    <li><a href="#medical" class="nav-link flex items-center p-3 my-1 rounded-lg font-semibold text-gray-600">Tıbbi Müdahale</a></li>
                </ul>
            </nav>
        </aside>

        
        <main class="flex-1 overflow-y-auto p-4 sm:p-8 bg-gray-100 relative">
             <button id="menu-toggle" class="sm:hidden p-2 mb-4 bg-white rounded-md border">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg>
            </button>
            
            <section id="dashboard" class="content-section">
                <h2 class="text-3xl font-bold mb-2 text-gray-800">Ana Kontrol Paneli</h2>
                <p class="mb-6 text-gray-500">Mevcut duruma ve gereken acil eylemlere hızlı bir genel bakış.</p>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200 flex flex-col justify-between">
                        <div>
                           <h3 class="font-bold text-lg mb-2">Mevcut Tehdit Durumu (THREATCON)</h3>
                           <p class="text-sm text-gray-500 mb-4">Bu seviye, tüm personelden beklenen hazırlık durumunu belirler.</p>
                        </div>
                        <div id="threat-level-card" class="text-center p-4 rounded-lg">
                            <div id="threat-level-text" class="text-4xl font-bold"></div>
                            <div id="threat-level-desc" class="mt-2 font-semibold"></div>
                        </div>
                         <div class="mt-4 flex justify-center">
                            <select id="threat-level-selector" class="p-2 border rounded-md w-full"></select>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200 lg:col-span-2">
                        <h3 class="font-bold text-lg mb-4">Anında Acil Durum Eylemleri</h3>
                        <p class="text-sm text-gray-500 mb-6">Acil bir durumda resmi talimatları izleyin. Bunlar temel prosedürlere hızlı bağlantılardır.</p>
                        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                            <button onclick="navigateTo('procedures', 'alpha')" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold p-4 rounded-lg text-center transition">
                                <span class="text-3xl">☢️</span>
                                <span class="block mt-2">Prosedür Alfa: Yerinde Sığınak</span>
                            </button>
                            <button onclick="navigateTo('procedures', 'bravo')" class="bg-blue-500 hover:bg-blue-600 text-white font-bold p-4 rounded-lg text-center transition">
                                <span class="text-3xl">🚗</span>
                                <span class="block mt-2">Prosedür Bravo: Tahliye</span>
                            </button>
                            <button onclick="navigateTo('procedures', 'charlie')" class="bg-red-500 hover:bg-red-600 text-white font-bold p-4 rounded-lg text-center transition">
                                <span class="text-3xl">🚨</span>
                                <span class="block mt-2">Prosedür Charlie: Terör Olayı</span>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="mt-8 bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                    <h3 class="font-bold text-lg mb-2">Güvenlik Durumuna Genel Bakış</h3>
                    <p class="text-gray-600">Bölgedeki mevcut güvenlik durumu değişkendir ve hızla tırmanma potansiyeline sahiptir. Bir nükleer tesise askeri saldırı gibi herhangi bir olay, daha geniş ve daha dinamik bir çatışmanın parçası olacaktır. Acil durum planı, askeri harekat, radyolojik kirlenme, terörizm ve sivil huzursuzluk dahil olmak üzere birden fazla krizi aynı anda yönetebilmelidir.</p>
                </div>
            </section>

            
            <section id="threats" class="content-section">
                <h2 class="text-3xl font-bold mb-2 text-gray-800">Radyolojik Tehditler ve Uyarı Sistemleri</h2>
                <p class="mb-6 text-gray-500">Potansiyel radyolojik riskleri ve resmi uyarıları nasıl alacağınızı anlayın.</p>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-bold text-lg mb-4">Radyolojik Tehdit: Buşehr Tesisi</h3>
                        <p class="text-sm text-gray-600 mb-4">Kuveyt için ana radyolojik tehdit, Körfez'in yaklaşık 290 km karşısında bulunan İran'ın Buşehr Nükleer Santrali'dir. Herhangi bir radyoaktif salınımın ulaşması rüzgar yönüne bağlıdır.</p>
                        <div class="relative w-full h-64 bg-blue-100 rounded-lg overflow-hidden border-2 border-blue-200">
                            <div class="absolute top-1/2 right-1/4 transform -translate-y-1/2 text-center">
                                <div class="w-4 h-4 bg-yellow-400 rounded-full animate-ping"></div>
                                <span class="font-bold text-blue-800">Kuveyt</span>
                            </div>
                            <div class="absolute top-1/2 left-1/4 transform -translate-y-1/2 text-center">
                                <div class="w-4 h-4 bg-red-600 rounded-full"></div>
                                <span class="font-bold text-red-800">Buşehr</span>
                            </div>
                            <div id="wind-plume" class="absolute top-1/2 left-1/4 h-1 bg-red-400/50 origin-left transition-all duration-1000" style="width: 150px;"></div>
                        </div>
                         <div class="mt-4 text-center">
                            <p class="text-sm mb-2">Rüzgar Yönünü Simüle Edin:</p>
                            <button id="shamal-wind-btn" class="px-4 py-2 bg-gray-200 rounded-md">Şimal Rüzgarı (Hakim)</button>
                            <button id="kaus-wind-btn" class="px-4 py-2 bg-red-200 rounded-md">Kaus Rüzgarı (Tehdit)</button>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-bold text-lg mb-4">Kuveyt Kamu Uyarı Sistemleri</h3>
                        <p class="text-sm text-gray-600 mb-4">Herhangi büyük bir olay için ilk uyarı Kuveyt makamlarından gelebilir. Sirenlerin ne anlama geldiğini bilin.</p>
                        <div id="siren-guide" class="space-y-3"></div>
                        <div class="source-citation">Kaynak: Kuveyt İçişleri Bakanlığı, Sivil Savunma Genel Müdürlüğü.</div>
                    </div>
                </div>
            </section>
            
            <section id="chemical" class="content-section">
                <h2 class="text-3xl font-bold mb-2 text-gray-800">Kimyasal Silah Tehditleri</h2>
                <p class="mb-6 text-gray-500">Sivil Savunma talimatlarına dayalı olarak kimyasal maddelere maruz kalma durumunda prosedürler ve ilk yardım.</p>
                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200 mb-6">
                    <h3 class="font-bold text-lg mb-4">Kimyasal Saldırılara Karşı Koruyucu Önlemler</h3>
                    <div id="chem-measures-accordion" class="space-y-4"></div>
                    <div class="source-citation">Kaynak: Kuveyt İçişleri Bakanlığı, "Kimyasal Silahlarla Saldırı Durumunda Önleyici Tedbirler".</div>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                    <h3 class="font-bold text-lg mb-4">Kimyasal Maddeler için Belirtiler ve İlk Yardım</h3>
                     <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left text-gray-500">
                            <thead class="text-xs text-gray-700 uppercase bg-gray-50">
                                <tr id="chem-table-header"></tr>
                            </thead>
                            <tbody id="chem-table-body"></tbody>
                        </table>
                    </div>
                     <div class="source-citation">Kaynak: Kuveyt İçişleri Bakanlığı, "Kimyasal Silahlarla Saldırı Durumunda Önleyici Tedbirler".</div>
                </div>
            </section>

            <section id="preparedness" class="content-section">
                <h2 class="text-3xl font-bold mb-2 text-gray-800">Kişisel ve Ailevi Hazırlık</h2>
                <p class="mb-6 text-gray-500">Önceden hazırlık, güvenliğin anahtarıdır. Ailenizi hazırlamak için bu araçları kullanın.</p>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-bold text-lg mb-4">Evde Kalma Kiti (2 Haftalık Tedarik)</h3>
                        <div id="stay-kit-checklist" class="space-y-3 max-h-96 overflow-y-auto ps-2"></div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-bold text-lg mb-4">Acil Durum Çantası (Kişi Başı - 72 Saat)</h3>
                        <div id="go-bag-checklist" class="space-y-3 max-h-96 overflow-y-auto ps-2"></div>
                    </div>
                </div>
                <div class="mt-8 bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                    <h3 class="font-bold text-lg mb-4">Aile Acil Durum Planı</h3>
                     <div class="space-y-4">
                        <div>
                            <label class="font-semibold">Ülke Dışı İrtibat Kişisi:</label>
                            <input type="text" placeholder="İsim, yakınlık ve telefon numarası" class="mt-1 w-full p-2 border rounded-md">
                        </div>
                        <div>
                            <label class="font-semibold">Buluşma Noktaları:</label>
                            <input type="text" placeholder="1. Evin yakını (ör. sokak köşesi)" class="mt-1 w-full p-2 border rounded-md">
                            <input type="text" placeholder="2. Mahallede (ör. park)" class="mt-2 w-full p-2 border rounded-md">
                            <input type="text" placeholder="3. Büyükelçilik toplanma alanı (talimata göre)" class="mt-2 w-full p-2 border rounded-md">
                        </div>
                        <div>
                            <label class="font-semibold">Önemli Belgeleri Saklayın:</label>
                            <p class="text-sm text-gray-600">Pasaportları, doğum belgelerini, sigorta poliçelerini toplayın. Acil durum çantanızda kağıt kopyalarını ve şifreli dijital kopyaları bir USB sürücüde veya güvenli bulut depolamada saklayın.</p>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="shelter" class="content-section">
                <h2 class="text-3xl font-bold mb-2 text-gray-800">Sığınak ve Korunma</h2>
                <p class="mb-6 text-gray-500">Güvenli bir sığınak oluşturma ve radyasyondan korunmayı anlama konusunda ayrıntılı rehberlik.</p>
                
                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200 mb-6">
                    <h3 class="font-bold text-lg mb-4">Ev Sığınağınızı Hazırlama</h3>
                    <p class="text-sm text-gray-600 mb-4">Radyolojik veya kimyasal bir acil durumda, en güvenli eylem içeri girmek ve dış hava ile aranızda bir bariyer oluşturmaktır. Sığınak odanızı önceden nasıl hazırlayacağınız aşağıda açıklanmıştır.</p>
                    <div id="home-shelter-steps" class="space-y-4"></div>
                     <div class="source-citation">Kaynak: Kuveyt İçişleri Bakanlığı, Sivil Savunma Genel Müdürlüğü.</div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-bold text-lg mb-4">Radyasyondan Korunmanın Temel İlkeleri</h3>
                        <p class="text-sm text-gray-600 mb-4">Güvenliğiniz üç temel ilkeye bağlıdır: Zaman, Mesafe ve Zırhlama. Maruziyetinizi en aza indirmek anahtardır.</p>
                        <div id="rad-protection-principles" class="space-y-4"></div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-bold text-lg mb-4">Genel Sığınak Bulucu</h3>
                        <p class="text-sm text-gray-600">Kuveyt Devleti genel sığınaklar bulundurmaktadır. Acil bir durumda, yetkililer sığınak yerlerini duyuracaktır. Resmi Sivil Savunma hizmetini kullanarak en yakın belirlenmiş sığınağı bulmak için bu aracı kullanın.</p>
                        
                        <div class="mt-4 space-y-4 p-4 border rounded-lg bg-gray-50">
                            <div>
                                <label for="gov-select" class="block text-sm font-medium text-gray-700">Valilik</label>
                                <select id="gov-select" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"></select>
                            </div>
                             <div>
                                <label for="area-select" class="block text-sm font-medium text-gray-700">Bölge</label>
                                <select id="area-select" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"></select>
                            </div>
                            <button id="search-shelter-btn" class="w-full bg-blue-600 text-white font-bold py-2 px-4 rounded-md hover:bg-blue-700 transition">Resmi Web Sitesinde Ara</button>
                            <p class="text-xs text-center text-gray-500">Bu, yeni bir pencerede resmi Kuveyt Sivil Savunma sığınak arama aracını açacaktır.</p>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="procedures" class="content-section">
                <h2 class="text-3xl font-bold mb-2 text-gray-800">Standart Operasyon Prosedürleri (SOP)</h2>
                <p class="mb-6 text-gray-500">Belirli acil durum senaryoları için net, adım adım talimatlar.</p>
                <div id="procedures-accordion" class="space-y-4"></div>
            </section>

            
            <section id="medical" class="content-section">
                <h2 class="text-3xl font-bold mb-2 text-gray-800">Tıbbi Müdahale ve Dekontaminasyon</h2>
                <p class="mb-6 text-gray-500">Sağlık risklerini ve maruziyeti azaltmak için olay sonrası hayati eylemler.</p>
                <div class="grid grid-cols-1 lg:grid-cols-5 gap-6">
                    <div class="lg:col-span-3 bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-bold text-lg mb-4">Radyolojik Dekontaminasyon</h3>
                        <p class="text-sm text-gray-600 mb-4">Radyoaktif bir salınım sırasında dışarıdaysanız, radyoaktif malzemeyi temizlemek için bu adımları derhal uygulayın.</p>
                        <ol id="decon-steps" class="list-decimal list-inside space-y-3">
                        </ol>
                         <div class="source-citation">Kaynak: Kuveyt İçişleri Bakanlığı, "Radyasyon ve Etkileri ve Önleme Yöntemleri".</div>
                    </div>
                    <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-bold text-lg mb-4">Potasyum İyodür (KI) Dozajları</h3>
                        <p class="text-sm text-gray-600 mb-4"><strong>Büyükelçilik tarafından açıkça emredilmedikçe ALMAYIN.</strong> Sadece tiroid bezini radyoaktif iyottan korur.</p>
                        <div class="chart-container">
                            <canvas id="ki-chart"></canvas>
                        </div>
                    </div>
                </div>
                 <div class="mt-8 bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                    <h3 class="font-bold text-lg mb-4">Detaylı Potasyum İyodür Dozaj Tablosu</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-gray-500">
                            <thead class="text-xs text-gray-700 uppercase bg-gray-50">
                                <tr id="ki-table-header"></tr>
                            </thead>
                            <tbody id="ki-table-body"></tbody>
                        </table>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            
            // --- DATA GENERATORS ---
            
            const shelterLocations = {
                'Valilik Seçin': [],
                'Al Asimah (Başkent)': ['Abdullah Al-Salem', 'Adailiya', 'Bneid Al-Qar', 'Daiya', 'Dasma', 'Faiha', 'Jibla', 'Kaifan', 'Khaldiya', 'Mansouriya', 'Mirqab', 'Nuzha', 'Qadsiya', 'Qortuba', 'Rawda', 'Salhiya', 'Shamiya', 'Sharq', 'Shuwaikh', 'Sulaibikhat', 'Yarmouk'],
                'Hawalli': ['Bayan', 'Hawalli', 'Jabriya', 'Mishref', 'Mubarak Al-Abdullah', 'Rumaithiya', 'Salmiya', 'Salwa', 'Shaab'],
                'Mubarak Al-Kabeer': ['Abu Al Hasaniya', 'Abu Ftaira', 'Adan', 'Al-Qurain', 'Al-Qusour', 'Fnaitees', 'Messila', 'Mubarak Al-Kabeer', 'Sabah Al-Salem', 'Wista'],
                'Al-Ahmadi': ['Abu Halifa', 'Ahmadi', 'Fahaheel', 'Fintas', 'Hadiya', 'Jaber Al-Ali', 'Mahboula', 'Mangaf', 'Reqqa', 'Sabahiya', 'Wafra', 'Zoor'],
                'Al-Farwaniya': ['Abdullah Al-Mubarak', 'Havaalanı', 'Andalous', 'Ardiya', 'Ashbelia', 'Dhajeej', 'Farwaniya', 'Fordous', 'Jleeb Al-Shuyoukh', 'Khaitan', 'Omariya', 'Rabia', 'Reggai', 'Rai'],
                'Al-Jahra': ['Amghara', 'Jahra', 'Kabd', 'Naeem', 'Naseem', 'Oyoun', 'Qasr', 'Saad Al Abdullah', 'Sulaibiya', 'Taima', 'Waha']
            };

            function getThreatLevels() {
                return {
                    '4': { text: 'Seviye 4', desc: 'Normal', color: 'bg-green-100', textColor: 'text-green-800' },
                    '3': { text: 'Seviye 3', desc: 'Artan Hazırlık', color: 'bg-blue-100', textColor: 'text-blue-800' },
                    '2': { text: 'Seviye 2', desc: 'Yüksek Alarm', color: 'bg-yellow-100', textColor: 'text-yellow-800' },
                    '1': { text: 'Seviye 1', desc: 'Kriz Müdahalesi', color: 'bg-red-100', textColor: 'text-red-800' }
                };
            }

            function getSirenData() {
                const data = [
                    { tone: 'Kesintili Ses', meaning: 'Yakın Tehlike / Uyarı', action: 'Olası bir tehlike yaklaşıyor. Normal aktiviteyi durdurun. İçeri girin. Yerel medyayı izleyin ve resmi bir Büyükelçilik uyarısı bekleyin. Acil durum prosedürlerini uygulamaya hazırlanın.'},
                    { tone: 'Dalgalı Ses', meaning: 'Tehlike Gerçekleşti', action: 'Felaket veya saldırı şu anda gerçekleşiyor. <strong>Derhal Yerinde Sığınak Prosedürünü (Prosedür Alfa) uygulayın.</strong> Belirlenen sığınak odanıza geçin. Büyükelçilik mesajı beklemeyin.'},
                    { tone: 'Sürekli Ses', meaning: 'Tehlike Geçti', action: 'Ani tehlike geçti. <strong>Sığınakta kalın.</strong> Büyükelçilikten resmi bir "TEHLİKE GEÇTİ" talimatı alana kadar ayrılmayın. Daha fazla talimat bekleyin.'}
                ];
                const colors = ['bg-blue-100', 'bg-yellow-100', 'bg-green-100'];
                return data.map((item, index) => ({ ...item, color: colors[index] }));
            }
            
            function getChemicalData() {
                return {
                    measures: [
                        { title: 'Saldırıdan Önce (Hazırlık)', content: '<ul><li>Sığınak odanızı hazırlayın (Sığınak bölümüne bakın).</li><li>Acil durum kitinizin plastik örtü, koli bandı ve makas içerdiğinden emin olun.</li><li>Havalandırma sistemlerini nasıl hızlıca kapatacağınızı öğrenin.</li><li>Gaz maskeniz varsa, kontrol edin ve yüzünüze tam oturduğundan emin olun.</li></ul>' },
                        { title: 'Saldırı Sırasında (Dışarıdaysanız)', content: '<ul><li>Saldırının yönünü belirlemeye çalışın ve rüzgarın tersi yönde hızla hareket edin.</li><li>Ağzınızı ve burnunuzu bir bezle kapatın (ıslak bez daha iyidir).</li><li>En yakın sağlam, kapalı binaya sığının.</li></ul>' },
                        { title: 'Saldırı Sırasında (Araçtaysanız)', content: '<ul><li>Tüm pencereleri kapatın ve tüm havalandırma ve klima sistemlerini kapatın.</li><li>Mümkünse etkilenen bölgeden araçla uzaklaşın.</li><li>Uzaklaşamıyorsanız, aracı park edin ve en yakın binaya sığının.</li></ul>' },
                        { title: 'Saldırıdan Sonra (Olay Sonrası Eylemler)', content: '<ul><li>Önceden seçtiğiniz sığınak odanıza gidin ve mühürleyin.</li><li>Dış katman giysilerinizi çıkarın, plastik bir torbaya koyup kapatın ve kendinizi sabun ve suyla iyice yıkayın.</li><li>Yetkililerden gelen resmi talimatlar için radyoyu dinleyin.</li><li>Kirlenmiş olabileceğinden şüphelendiğiniz yiyecek veya suyu tüketmeyin.</li></ul>' }
                    ],
                    firstAidHeaders: ['Ajan Tipi', 'Belirtiler', 'İlk Yardım'],
                    firstAid: [
                        { type: 'Sinir Gazları (örn. Sarin)', symptoms: 'Nefes almada zorluk, göz bebeklerinde daralma, salya akması, kasılmalar, bilinç kaybı.', aid: 'Derhal temiz havaya çıkın. Kirlenmiş giysileri çıkarın. Cildi ve gözleri bol su ile yıkayın. Acil tıbbi yardım alın.' },
                        { type: 'Yakıcı Gazlar (örn. Hardal Gazı)', symptoms: 'Ciltte kızarıklık ve kabarcıklar (şiddetli yanıklar gibi), göz tahrişi, solunum sorunları.', aid: 'Temiz havaya çıkın. Kirlenmiş giysileri çıkarın. Cildi su ile yıkayın. Kabarcıkları patlatmayın. Acil tıbbi yardım alın.' }
                    ]
                };
            }

            function getKitData() {
                return {
                    stayKit: ['Su (kişi başı günde 4 litre)', 'Dayanıksız gıda (2 haftalık tedarik)', 'Manuel konserve açacağı', 'Plastik örtü ve koli bandı', 'Toz maskeleri (N95 veya P100)', 'Kapsamlı ilk yardım kiti', 'Kişisel ilaçlar (1 aylık tedarik)', 'Pilli veya elle çalışan radyo', 'Yedek piller', 'El fenerleri', 'Hijyen malzemeleri (ıslak mendil vb.)'].map(text => ({ text, checked: false })),
                    goBag: ['Su ve yiyecek (3 günlük tedarik)', 'Yedek giysi ve sağlam ayakkabılar', 'Önemli belgelerin kopyaları', 'Küçük banknotlar halinde nakit', 'Gerekli ilaçlar (7 günlük tedarik)', 'Mühürlü bir torbada temiz giysiler', 'Küçük ilk yardım kiti', 'Taşınabilir radyo ve el feneri', 'Yedek piller', 'Yerel harita'].map(text => ({ text, checked: false }))
                };
            }
            
            function getProceduresData() {
                return [
                    { id: 'alpha', title: 'Prosedür Alfa: Yerinde Sığınak (Radyolojik/Kimyasal)', icon: '☢️', content: '<p class="mb-4">Amaç, sizi havadaki kirleticilerden korumaktır...</p><p class="font-bold text-lg mb-2 text-center">"İçeri Gir, İçeride Kal, Dinle"</p><ol class="list-decimal list-inside space-y-2"><li><strong>İçeri Gir:</strong> Derhal en yakın sağlam binaya girin.</li><li><strong>İçeride Kal:</strong> Önceden belirlenmiş sığınak odanıza geçin.</li><li><strong>Mühürle:</strong> Pencereleri ve kapıları kapatın. Tüm klima ve havalandırma sistemlerini kapatın. "Sığınak" bölümündeki ayrıntılı mühürleme adımlarını izleyin.</li><li><strong>Dinle:</strong> Resmi talimatlar için radyonuzu kullanın.</li><li><strong>Ayrılma:</strong> Resmi bir "TEHLİKE GEÇTİ" talimatı alana kadar sığınakta kalın.</li></ol>' },
                    { id: 'bravo', title: 'Prosedür Bravo: Tahliye', icon: '🚗', content: '<p class="mb-4">Tahliye yalnızca Misyon Şefi tarafından emredilecektir...</p><p class="font-bold mb-2">Tahliye emri alındığında:</p><ol class="list-decimal list-inside space-y-2"><li>Sakin olun ve dinleyin.</li><li>Ailenizi ve acil durum çantalarınızı toplayın.</li><li>Zaman varsa, ana şebekeleri kapatın.</li><li>Evinizi kilitleyin.</li><li>Belirlenen toplanma noktasına gidin.</li><li>Varışta derhal kayıt yaptırın.</li></ol>' },
                    { id: 'charlie', title: 'Prosedür Charlie: Terör Olayı', icon: '🚨', content: '<p class="mb-4">Bölge Güvenlik Görevlisinin (RSO) talimatlarını izleyin...</p><div class="space-y-4"><h4 class="font-bold">Aktif bir saldırgan durumunda:</h4><ul class="list-disc list-inside"><li><strong>Kaç:</strong> Güvenli bir kaçış yolu varsa, derhal ayrılın.</li><li><strong>Saklan:</strong> Kaçamazsanız, güvenli bir yer bulun.</li><li><strong>Savaş:</strong> Son çare olarak, fiziksel saldırganlıkla hareket edin.</li></ul></div>' }
                ];
            }

            function getDeconData() {
                return ['<strong>Dış giysileri çıkarın:</strong> Dış giysi katmanını sallamaktan kaçınarak dikkatlice çıkarın. Plastik bir torbaya koyun ve ağzını kapatın. Bu torbayı insanlardan ve evcil hayvanlardan uzak tutun.', '<strong>İyice yıkanın:</strong> Ilık (sıcak değil) bir duş alın, tüm vücudunuzu ve saçınızı sabun ve şampuanla yıkayın. Duş imkanı yoksa, tüm açık ten bölgelerini, özellikle elleri ve yüzü temizlemek için ıslak mendil veya ıslak bir bez kullanın.', '<strong>Temiz giysiler giyin:</strong> Kirli havadan uzakta, kapalı bir çekmece veya dolapta saklanan tamamen temiz giysiler giyin.', '<strong>Mümkünse başkalarına yardım edin:</strong> Başkalarının dekontaminasyonuna yardım etmeniz gerekiyorsa, su geçirmez eldiven ve maske takmaya çalışın. Onlara da aynı adımları izlemelerini tavsiye edin.'];
            }

            function getKiData() {
                return {
                    chartLabel: 'Potasyum İyodür Dozu (mg)',
                    chartTitle: 'Yaş Grubuna Göre Dozajlar',
                    labels: ['Yenidoğan (0-1 ay)', 'Bebekler (1-3 yaş)', 'Çocuklar (3-12 yaş)', 'Ergenler (12-18)', 'Yetişkinler (18-40)', 'Hamile/Emziren'],
                    dosages: [16.25, 32.5, 65, 130, 130, 130],
                    tableHeaders: ['Yaş Grubu', 'Önerilen Doz', 'Önemli Notlar'],
                    table: [
                      { age: '40 yaş üstü yetişkinler', dose: '130 mg', notes: 'Genellikle tavsiye edilmez.' },
                      { age: '18 ila 40 yaş arası yetişkinler', dose: '130 mg', notes: 'Standart yetişkin dozu.' },
                      { age: 'Hamile ve Emziren Kadınlar', dose: '130 mg', notes: 'En yüksek öncelik. Tek doz.' },
                      { age: 'Ergenler (12 ila 18 yaş)', dose: '130 mg', notes: 'Standart yetişkin dozu.' },
                      { age: 'Çocuklar (3 ila 12 yaş)', dose: '65 mg', notes: 'Yetişkin dozunun yarısı.' },
                      { age: 'Bebekler (1 ay ila 3 yaş)', dose: '32.5 mg', notes: 'Yetişkin dozunun çeyreği.' },
                      { age: 'Yenidoğanlar (doğumdan 1 aya kadar)', dose: '16.25 mg', notes: 'Yetişkin dozunun sekizde biri. Tek doz.' }
                    ]
                };
            }
            
            function getShelterData() {
                return {
                    steps: [
                        { title: 'Adım 1: En İyi Odayı Seçin', text: 'Tercihen bodrum katında veya zemin katta, en az pencere ve kapıya sahip bir iç oda seçin. Amaç, sizinle dışarısı arasına mümkün olduğunca fazla katı malzeme koymaktır.' },
                        { title: 'Adım 2: Malzemeleri Önceden Toplayın', text: 'Evde Kalma Kitinizi, sızdırmazlık malzemeleri (plastik örtü, koli bandı) dahil olmak üzere, hızlı erişim için sığınak odanızda veya yakınında saklayın.' },
                        { title: 'Adım 3: Talimat Verildiğinde Odayı Mühürleyin', text: 'Sığınma talimatı verildiğinde, tüm vantilatörleri, klimaları ve ısıtma sistemlerini kapatın. Pencereleri, prizleri ve havalandırmaları örtmek için koli bandı ve plastik örtü kullanın. Havadaki partiküllere karşı daha iyi bir sızdırmazlık sağlamak için kapıların altına ıslak havlular yerleştirin.' },
                        { title: 'Adım 4: İçeride Kalın ve Talimatları Dinleyin', text: 'Mühürlenmiş odada kalın. Yetkililerden gelen resmi talimatları dinlemek için pilli radyonuzu kullanın. "Tehlike Geçti" mesajını alana kadar ayrılmayın.' }
                    ],
                    principles: [
                        { title: 'Zaman', text: 'Maruz kalma sürenizi sınırlayın. Bir radyasyon kaynağının yakınında ne kadar az zaman geçirirseniz, dozunuz o kadar düşük olur. Önerilen süre boyunca sığınağınızda kalma talimatlarını izleyin.' },
                        { title: 'Mesafe', text: 'Bir radyasyon kaynağından ne kadar uzakta olursanız o kadar güvende olursunuz. Radyasyonun yoğunluğu mesafe ile önemli ölçüde azalır. Bu nedenle tahliye (güvenli kabul edildiğinde) önemli bir stratejidir.' },
                        { title: 'Zırhlama', text: 'Sizinle radyasyon kaynağı arasına yoğun bir malzeme (kalkan) yerleştirin. Beton, tuğla ve toprak mükemmel zırhlama malzemeleridir. Merkezi, penceresiz bir odada veya bodrum katında sığınmanın arkasındaki ilke budur.' }
                    ]
                };
            }


            // --- ELEMENTS ---
            const navLinks = document.querySelectorAll('.nav-link');
            const contentSections = document.querySelectorAll('.content-section');
            const threatLevelSelector = document.getElementById('threat-level-selector');
            const threatLevelCard = document.getElementById('threat-level-card');
            const threatLevelText = document.getElementById('threat-level-text');
            const threatLevelDesc = document.getElementById('threat-level-desc');
            const menuToggle = document.getElementById('menu-toggle');
            const sidebar = document.getElementById('sidebar');
            const govSelect = document.getElementById('gov-select');
            const areaSelect = document.getElementById('area-select');
            const searchShelterBtn = document.getElementById('search-shelter-btn');
            let kiChartInstance;

            // --- FUNCTIONS ---
            function navigateTo(sectionId, subSectionId = null) {
                contentSections.forEach(section => section.classList.remove('active'));
                const activeSection = document.getElementById(sectionId);
                if (activeSection) activeSection.classList.add('active');

                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href') === `#${sectionId}`) link.classList.add('active');
                });
                
                if(sidebar.classList.contains('translate-x-0')) {
                    sidebar.classList.remove('translate-x-0');
                    sidebar.classList.add('-translate-x-full');
                }

                if (subSectionId) {
                    const element = document.getElementById(subSectionId);
                    if (element && element.closest('.accordion-toggle')) {
                        document.querySelectorAll('.accordion-toggle').forEach(acc => {
                           acc.nextElementSibling.style.maxHeight = null;
                           acc.querySelector('span:last-child').style.transform = 'rotate(0deg)';
                        });
                        const content = element.nextElementSibling;
                        content.style.maxHeight = content.scrollHeight + "px";
                        element.querySelector('span:last-child').style.transform = 'rotate(180deg)';
                        element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                }
            }
            
            function updateThreatLevel(level) {
                const threatLevels = getThreatLevels();
                const levelData = threatLevels[level];
                threatLevelText.textContent = levelData.text;
                threatLevelDesc.textContent = levelData.desc;
                threatLevelCard.className = 'text-center p-4 rounded-lg transition-colors duration-300 ' + levelData.color + ' ' + levelData.textColor;
            }

            function populateThreatSelector() {
                const threatLevels = getThreatLevels();
                const currentVal = threatLevelSelector.value || '4';
                threatLevelSelector.innerHTML = '';
                Object.entries(threatLevels).forEach(([key, val]) => {
                    const option = document.createElement('option');
                    option.value = key;
                    option.textContent = `${val.text}: ${val.desc}`;
                    threatLevelSelector.appendChild(option);
                });
                threatLevelSelector.value = currentVal;
            }
            
            function createChecklist(containerId, data) {
                const container = document.getElementById(containerId);
                container.innerHTML = '';
                data.forEach(item => {
                    const label = document.createElement('label');
                    label.className = 'flex items-center p-2 bg-gray-50 rounded-md hover:bg-gray-100 cursor-pointer';
                    const checkbox = document.createElement('input');
                    checkbox.type = 'checkbox';
                    checkbox.className = 'mr-3 form-checkbox h-5 w-5 text-blue-600 rounded';
                    checkbox.checked = item.checked;
                    label.appendChild(checkbox);
                    label.append(item.text);
                    container.appendChild(label);
                });
            }
            
            function populateSirens() {
                const container = document.getElementById('siren-guide');
                container.innerHTML = '';
                getSirenData().forEach(siren => {
                    const div = document.createElement('div');
                    div.className = `p-4 rounded-lg border cursor-pointer ${siren.color}`;
                    div.innerHTML = `
                        <div class="flex justify-between items-center">
                            <h4 class="font-bold">${siren.tone}</h4>
                            <span class="text-sm font-semibold">${siren.meaning}</span>
                        </div>
                        <p class="siren-action mt-2 text-sm hidden">${siren.action}</p>
                    `;
                    div.addEventListener('click', () => div.querySelector('.siren-action').classList.toggle('hidden'));
                    container.appendChild(div);
                });
            }
            
            function populateProcedures(containerId, data) {
                const container = document.getElementById(containerId);
                container.innerHTML = '';
                data.forEach(item => {
                    const div = document.createElement('div');
                    div.className = 'bg-white rounded-xl shadow-sm border border-gray-200';
                    div.innerHTML = `
                        <button id="${item.id || ''}" class="accordion-toggle w-full p-4 text-left flex justify-between items-center font-bold text-lg">
                            <span>${item.icon || ''} ${item.title}</span>
                            <span class="transform transition-transform duration-300">▼</span>
                        </button>
                        <div class="accordion-content px-4 pb-4 text-gray-600">${item.content}</div>
                    `;
                    container.appendChild(div);
                });
                document.querySelectorAll('.accordion-toggle').forEach(button => {
                    button.addEventListener('click', () => {
                        const content = button.nextElementSibling;
                        const icon = button.querySelector('span:last-child');
                        const isOpen = content.style.maxHeight;
                        const allContent = button.closest('.space-y-4').querySelectorAll('.accordion-content');
                        const allIcons = button.closest('.space-y-4').querySelectorAll('.accordion-toggle span:last-child');
                        allContent.forEach(c => c.style.maxHeight = null);
                        allIcons.forEach(i => i.style.transform = 'rotate(0deg)');
                        
                        if (!isOpen || content.style.maxHeight === '0px') {
                            content.style.maxHeight = content.scrollHeight + "px";
                            icon.style.transform = 'rotate(180deg)';
                        } else {
                            content.style.maxHeight = null;
                            icon.style.transform = 'rotate(0deg)';
                        }
                    });
                });
            }

            function populateChemicalSection() {
                const chemData = getChemicalData();
                populateProcedures('chem-measures-accordion', chemData.measures.map(m => ({...m, icon: '☣️'})));

                const thead = document.getElementById('chem-table-header');
                thead.innerHTML = '';
                chemData.firstAidHeaders.forEach(header => {
                    const th = document.createElement('th');
                    th.scope = 'col';
                    th.className = 'px-6 py-3';
                    th.textContent = header;
                    thead.appendChild(th);
                });

                const tbody = document.getElementById('chem-table-body');
                tbody.innerHTML = '';
                chemData.firstAid.forEach(row => {
                    const tr = document.createElement('tr');
                    tr.className = 'bg-white border-b';
                    tr.innerHTML = `
                        <th scope="row" class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap">${row.type}</th>
                        <td class="px-6 py-4">${row.symptoms}</td>
                        <td class="px-6 py-4">${row.aid}</td>
                    `;
                    tbody.appendChild(tr);
                });
            }

            function populateDeconSteps() {
                const container = document.getElementById('decon-steps');
                container.innerHTML = '';
                getDeconData().forEach(step => {
                    const li = document.createElement('li');
                    li.innerHTML = step;
                    container.appendChild(li);
                });
            }

            function populateKiTable() {
                const kiData = getKiData();
                const thead = document.getElementById('ki-table-header');
                thead.innerHTML = '';
                kiData.tableHeaders.forEach(header => {
                    const th = document.createElement('th');
                    th.scope = 'col';
                    th.className = 'px-6 py-3';
                    th.textContent = header;
                    thead.appendChild(th);
                });

                const tbody = document.getElementById('ki-table-body');
                tbody.innerHTML = '';
                kiData.table.forEach(row => {
                    const tr = document.createElement('tr');
                    tr.className = 'bg-white border-b';
                    tr.innerHTML = `
                        <th scope="row" class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap">${row.age}</th>
                        <td class="px-6 py-4">${row.dose}</td>
                        <td class="px-6 py-4">${row.notes}</td>
                    `;
                    tbody.appendChild(tr);
                });
            }

            function createKiChart() {
                if (kiChartInstance) {
                    kiChartInstance.destroy();
                }
                const kiData = getKiData();
                const ctx = document.getElementById('ki-chart').getContext('2d');
                kiChartInstance = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: kiData.labels,
                        datasets: [{
                            label: kiData.chartLabel,
                            data: kiData.dosages,
                            backgroundColor: 'rgba(59, 130, 246, 0.5)',
                            borderColor: 'rgba(59, 130, 246, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false, indexAxis: 'y',
                        scales: { x: { beginAtZero: true } },
                        plugins: { legend: { display: false }, title: { display: true, text: kiData.chartTitle } }
                    }
                });
            }
            
            function populateShelterLocator() {
                govSelect.innerHTML = '';
                Object.keys(shelterLocations).forEach(gov => {
                    const option = document.createElement('option');
                    option.value = gov;
                    option.textContent = gov;
                    govSelect.appendChild(option);
                });
                govSelect.dispatchEvent(new Event('change'));
            }

            function updateAreaDropdown() {
                const selectedGov = govSelect.value;
                const areas = shelterLocations[selectedGov] || [];
                areaSelect.innerHTML = '';
                
                if (areas.length === 0) {
                     const option = document.createElement('option');
                     option.textContent = 'Bölge Seçin';
                     areaSelect.appendChild(option);
                }

                areas.forEach(area => {
                    const option = document.createElement('option');
                    option.value = area;
                    option.textContent = area;
                    areaSelect.appendChild(option);
                });
            }
            
            function populateShelterInfo() {
                const shelterData = getShelterData();
                const stepsContainer = document.getElementById('home-shelter-steps');
                stepsContainer.innerHTML = '';
                shelterData.steps.forEach(step => {
                    const div = document.createElement('div');
                    div.innerHTML = `<h4 class="font-semibold text-md text-gray-700">${step.title}</h4><p class="text-sm text-gray-600">${step.text}</p>`;
                    stepsContainer.appendChild(div);
                });

                const principlesContainer = document.getElementById('rad-protection-principles');
                principlesContainer.innerHTML = '';
                shelterData.principles.forEach(principle => {
                    const div = document.createElement('div');
                    div.innerHTML = `<h4 class="font-semibold text-md text-gray-700">${principle.title}</h4><p class="text-sm text-gray-600">${principle.text}</p>`;
                    principlesContainer.appendChild(div);
                });
                
                populateShelterLocator();
            }

            // --- EVENT LISTENERS ---
            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    navigateTo(e.currentTarget.getAttribute('href').substring(1));
                });
            });

            threatLevelSelector.addEventListener('change', (e) => {
                updateThreatLevel(e.target.value);
            });
            
            menuToggle.addEventListener('click', () => {
                sidebar.classList.toggle('-translate-x-full');
                sidebar.classList.toggle('translate-x-0');
            });

            document.getElementById('shamal-wind-btn').addEventListener('click', () => {
                const plume = document.getElementById('wind-plume');
                plume.style.transform = 'translateY(-50%) rotate(-45deg)';
            });

            document.getElementById('kaus-wind-btn').addEventListener('click', () => {
                const plume = document.getElementById('wind-plume');
                plume.style.transform = 'translateY(-50%) rotate(45deg)';
            });
            
            govSelect.addEventListener('change', () => {
                updateAreaDropdown();
            });
            
            searchShelterBtn.addEventListener('click', () => {
                window.open('https://www.moi.gov.kw/main/eservices/civildefence/shelters', '_blank');
            });

            // --- INITIALIZATION ---
            function init() {
                populateThreatSelector();
                updateThreatLevel('4');
                populateSirens();
                const kitData = getKitData();
                createChecklist('stay-kit-checklist', kitData.stayKit);
                createChecklist('go-bag-checklist', kitData.goBag);
                populateProcedures('procedures-accordion', getProceduresData());
                populateChemicalSection();
                populateDeconSteps();
                populateKiTable();
                createKiChart();
                populateShelterInfo();

                const hash = window.location.hash.substring(1) || 'dashboard';
                navigateTo(hash);
                document.getElementById('shamal-wind-btn').click();
            }
            
            init();

            window.navigateTo = navigateTo;
        });
    </script>
</body>
</html>
